(this["webpackJsonpcontent-sale-system"]=this["webpackJsonpcontent-sale-system"]||[]).push([[0],{38:function(e,t,c){},56:function(e,t,c){},58:function(e,t,c){},63:function(e,t,c){},64:function(e,t,c){},66:function(e,t,c){},67:function(e,t,c){},68:function(e,t,c){},69:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),r=c(31),i=c.n(r),s=(c(38),c(6)),l=c(7),u=c(4),j=c(14),d=c(2),o=c.n(d),b={ENV:"prod"},h=b.ENV,p={list:function(){return"dev"===h?o.a.get("http://localhost:8080/api/product",{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/product").then((function(e){return e.data}))},getProductDetail:function(e){return"dev"===h?o.a.get("http://localhost:8080/api/product/".concat(e),{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/product/".concat(e)).then((function(e){return e.data}))},editProduct:function(e){return"dev"===h?o.a.post("http://localhost:8080/api/product",e,{withCredentials:!0}).then((function(e){return e.data})):o.a.post("/api/product",e).then((function(e){return e.data}))},delete:function(e){return"dev"===h?o.a.delete("http://localhost:8080/api/product/".concat(e),{withCredentials:!0}).then((function(e){return e.data})):o.a.delete("/api/product/".concat(e)).then((function(e){return e.data}))}},O={BUYER:"BUYER",SELLER:"SELLER"},f=(c(56),c(0));var x=function(e){var t=e.user,c=Object(n.useState)(!1),a=Object(s.a)(c,2),r=a[0],i=a[1],l=Object(n.useState)([]),u=Object(s.a)(l,2),d=u[0],o=u[1];return Object(n.useEffect)((function(){p.list().then((function(e){return o(e.data)}))}),[]),Object(f.jsxs)("div",{className:"p-container",children:[Object(f.jsx)("div",{className:"tab",children:Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{className:"sel"+(r?"":" active"),onClick:function(){return i(!1)},children:"\u6240\u6709\u5185\u5bb9"}),Object(f.jsx)("li",{className:"sel"+(r?" active":""),onClick:function(){return i(!0)},children:t&&t.userType===O.SELLER?"\u672a\u552e\u51fa\u7684\u5185\u5bb9":"\u672a\u8d2d\u4e70\u7684\u5185\u5bb9"})]})}),Object(f.jsx)("div",{className:"p-list",children:Object(f.jsx)("ul",{children:d.filter((function(e){return!r||e.traded===!r})).map((function(e,c){return Object(f.jsxs)("li",{children:[Object(f.jsxs)("a",{href:"/product/".concat(e.id),children:[Object(f.jsx)("div",{className:"img",children:Object(f.jsx)("img",{src:e.imgUrl,alt:e.name})}),Object(f.jsx)("h3",{children:e.name}),Object(f.jsxs)("div",{className:"price",children:[Object(f.jsx)("span",{className:"unit",children:"\uffe5"}),Object(f.jsx)("span",{className:"value",children:e.price})]}),e.traded&&Object(f.jsx)("span",{className:"had",children:Object(f.jsx)("b",{children:t&&t.userType===O.BUYER?"\u5df2\u8d2d\u4e70":"\u5df2\u552e\u51fa"})})]}),t&&t.userType===O.SELLER&&r?Object(f.jsx)("button",{onClick:(n=e.id,function(){window.confirm("\u786e\u8ba4\u5220\u9664\u8be5\u5546\u54c1\uff1f")&&p.delete(n).then((function(){var e,t=[],c=Object(j.a)(d);try{for(c.s();!(e=c.n()).done;){var a=e.value;a.id!==n&&t.push(a)}}catch(r){c.e(r)}finally{c.f()}o(t)}))}),children:"\u5220\u9664"}):""]},c);var n}))})})]})},m=c(3),v=b.ENV,g={list:function(){return"dev"===v?o.a.get("http://localhost:8080/api/cart",{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/cart").then((function(e){return e.data}))},editCart:function(e){return"dev"===v?o.a.post("http://localhost:8080/api/cart",e,{withCredentials:!0}).then((function(e){return e.data})):o.a.post("/api/cart",e).then((function(e){return e.data}))},checkout:function(){return"dev"===v?o.a.get("http://localhost:8080/api/cart/checkout",{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/cart/checkout").then((function(e){return e.data}))}};c(58);var N=function(e){var t=e.user,c=Object(u.g)().productId,a=Object(n.useState)({}),r=Object(s.a)(a,2),i=r[0],l=r[1],j=Object(n.useState)(0),d=Object(s.a)(j,2),o=d[0],b=d[1];function h(){var e=Object(m.a)(Object(m.a)({productId:c},i),{},{description:null,count:o});g.editCart(e).then((function(e){return console.log(e)||window.alert("\u6dfb\u52a0\u6210\u529f")})).catch((function(e){return console.log(e)||window.alert("\u6dfb\u52a0\u5931\u8d25")}))}function x(){return[Object(f.jsx)("button",{className:"cart-btn",onClick:h,children:"\u6dfb\u52a0\u81f3\u8d2d\u7269\u8f66"}),i.traded?Object(f.jsxs)("span",{children:["\u5df2\u8d2d\u4e70\u5f53\u65f6\u8d2d\u4e70\u4ef7\u683c\uff1a\uffe5",i.price]},"old-price"):null]}function v(){return Object(f.jsx)("a",{href:"/publish/".concat(i.productId),children:"\u7f16\u8f91"})}return Object(n.useEffect)((function(){document.title="\u5546\u54c1\u8be6\u60c5",p.getProductDetail(c).then((function(e){return l(e.data)}))}),[]),Object(f.jsxs)("div",{className:"p-container",children:[Object(f.jsxs)("div",{className:"wrapper",children:[Object(f.jsx)("div",{className:"img-container",children:Object(f.jsx)("img",{src:i.imgUrl})}),Object(f.jsxs)("div",{className:"cnt",children:[Object(f.jsx)("h2",{children:i.name}),Object(f.jsx)("span",{className:"abstract",children:i.productAbstract}),Object(f.jsxs)("div",{className:"price",children:[Object(f.jsx)("span",{className:"unit",children:"\uffe5"}),Object(f.jsx)("span",{className:"value",children:i.price})]}),Object(f.jsxs)("div",{className:"num",children:[Object(f.jsx)("span",{children:"\u8d2d\u4e70\u6570\u91cf\uff1a"}),Object(f.jsx)("input",{type:"number",value:o,onChange:function(e){return b(e.target.value)}})]}),Object(f.jsx)("div",{children:t&&t.userType===O.BUYER?Object(f.jsx)(x,{}):Object(f.jsx)(v,{})})]})]}),Object(f.jsxs)("div",{className:"full-desc",children:[Object(f.jsx)("div",{className:"desc-title",children:Object(f.jsx)("h2",{children:"\u8be6\u7ec6\u4fe1\u606f"})}),Object(f.jsx)("div",{className:"detail",children:i.description})]})]})},w={list:function(){return o.a.get(b+"/api/account",{withCredentials:!0}).then((function(e){return e.data}))}};c(63);function C(e){var t=e.item,c=Object(u.f)();return Object(f.jsxs)("li",{className:"item",onClick:function(){return c.push("/product/".concat(t.productId))},children:[Object(f.jsx)("img",{src:t.imgUrl,className:"p-img"}),Object(f.jsxs)("div",{className:"p-container",children:[Object(f.jsx)("h4",{children:t.productName}),Object(f.jsx)("span",{className:"abstract",children:t.productAbstract}),Object(f.jsxs)("span",{className:"price",children:["\u5355\u4ef7: ",t.price]}),Object(f.jsx)("div",{className:"p-cnt",children:Object(f.jsxs)("span",{children:["\u6570\u91cf\uff1a",t.count]})})]})]})}var y=function(e){e.user;var t=Object(n.useState)([]),c=Object(s.a)(t,2),a=c[0],r=c[1];Object(n.useEffect)((function(){document.title="\u8d26\u6237",w.list().then((function(e){return r(e.data)}))}),[]);var i=a.map((function(e,t){return Object(f.jsx)(C,{item:e},t)}));return Object(f.jsxs)("div",{className:"account",children:[Object(f.jsx)("div",{className:"a-head",children:Object(f.jsx)("h2",{children:"\u5df2\u8d2d\u4e70\u7684\u5546\u54c1"})}),Object(f.jsx)("ul",{children:i})]})};c(64);var E=function(){var e=Object(u.f)(),t=Object(n.useState)({userId:null,cartItems:[],totalPrice:0}),c=Object(s.a)(t,2),a=c[0],r=c[1];function i(e){return function(t){var c=t.target.value;c<0&&(c=0),r(Object(m.a)(Object(m.a)({},a),{},{cartItems:a.cartItems.splice(e,1,Object(m.a)(Object(m.a)({},a.cartItems[e]),{},{count:c}))})),g.editCart(Object(m.a)(Object(m.a)({},a.cartItems[e]),{},{count:a.cartItems[e].count})).then((function(){var e,t=0,c=Object(j.a)(a.cartItems);try{for(c.s();!(e=c.n()).done;){var n=e.value;t+=n.count*n.price}}catch(i){c.e(i)}finally{c.f()}r(Object(m.a)(Object(m.a)({},a),{},{totalPrice:t}))})).catch((function(e){console.log(e),window.alert("\u66f4\u65b0\u5931\u8d25")}))}}return Object(n.useEffect)((function(){return g.list().then((function(e){r(e.data),document.title="\u8d2d\u7269\u8f66"}))}),[]),Object(f.jsxs)("div",{className:"cart",children:[Object(f.jsx)("div",{className:"c-head",children:Object(f.jsx)("h2",{children:"\u5df2\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66\u7684\u5185\u5bb9"})}),Object(f.jsx)("ul",{children:a.cartItems&&a.cartItems.map((function(t,c){return Object(f.jsxs)("li",{className:"item",onClick:function(){return e.push("/product/".concat(t.productId))},children:[Object(f.jsx)("img",{src:t.imgUrl,className:"p-img"}),Object(f.jsxs)("div",{className:"p-container",children:[Object(f.jsx)("h4",{children:t.name}),Object(f.jsx)("span",{className:"abstract",children:t.productAbstract}),Object(f.jsxs)("span",{className:"price",children:["\u5355\u4ef7: \uffe5",t.price]}),Object(f.jsxs)("div",{className:"p-cnt",children:[Object(f.jsx)("span",{children:"\u6570\u91cf\uff1a"}),Object(f.jsx)("input",{type:"number",onChange:i(c),value:t.count})]})]})]},c)}))}),Object(f.jsxs)("div",{className:"cart-total",children:[Object(f.jsxs)("span",{className:"tot-price",children:["\u603b\u4ef7\uff1a\uffe5",a.totalPrice]}),Object(f.jsx)("br",{}),Object(f.jsx)("button",{className:"pay-btn",onClick:function(){g.checkout().then((function(){return r({cart:a,cartItems:[]})}))},children:"\u7ed3\u7b97"})]}),Object(f.jsx)("button",{className:"quit",onClick:function(){return e.go(-1)},children:"\u9000\u51fa"})]})},S=c(33),I=c.n(S),U=b.ENV,k={login:function(e){return"dev"===U?o.a.post("http://localhost:8080/api/login",e,{withCredentials:!0}).then((function(e){return e.data})):o.a.post("/api/login",e).then((function(e){return e.data}))},logout:function(){return"dev"===U?o.a.get("http://localhost:8080/api/logout",{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/logout").then((function(e){return e.data}))},getCurrentUser:function(){return"dev"===U?o.a.get("http://localhost:8080/api/user",{withCredentials:!0}).then((function(e){return e.data})):o.a.get("/api/user").then((function(e){return e.data}))}},R={SUCCESS:0,ERROR:-1};c(66);var L=function(){Object(u.f)();var e=Object(n.useState)(""),t=Object(s.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)(""),i=Object(s.a)(r,2),l=i[0],j=i[1];return Object(n.useEffect)((function(){return document.title="\u767b\u5f55"}),[]),Object(f.jsx)("div",{className:"login",children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={};t.username=c,t.password=I()(l).toLowerCase(),c&&l?k.login(t).then((function(e){e.status==R.ERROR&&(window.alert("\u767b\u5f55\u5931\u8d25!\u8bf7\u68c0\u67e5\u7528\u6237\u540d\u6216\u5bc6\u7801"),j("")),window.location.href="/"})).catch((function(e){window.alert("\u672a\u77e5\u9519\u8bef")})):window.alert("\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01")},children:[Object(f.jsxs)("div",{className:"form-item",children:[Object(f.jsx)("span",{children:"\u7528\u6237\u540d:"}),Object(f.jsx)("input",{type:"form-item",value:c,name:"username",onChange:function(e){return a(e.target.value)}})]}),Object(f.jsxs)("div",{className:"form-item",children:[Object(f.jsx)("span",{children:"\u5bc6\u7801:"}),Object(f.jsx)("input",{type:"password",value:l,name:"password",onChange:function(e){return j(e.target.value)}})]}),Object(f.jsx)("input",{className:"sub-btn",type:"submit",value:"\u767b\u5f55"})]})})},A=(c(67),b.ENV);var B=function(e){var t=Object(u.f)();e.user,Object(n.useEffect)((function(){return document.title="\u5546\u54c1\u53d1\u5e03"}),[]);var c=Object(u.g)().productId,a=Object(n.useState)({id:c,name:null,productAbstract:null,description:null,imgUrl:null,price:null}),r=Object(s.a)(a,2),i=r[0],l=r[1],j=Object(n.useState)(!0),d=Object(s.a)(j,2),b=d[0],h=d[1];return Object(n.useEffect)((function(){c&&""!==c&&p.getProductDetail(c).then((function(e){return l(e.data)}))}),[]),Object(f.jsxs)("div",{className:"p-pub",children:[Object(f.jsx)("div",{className:"head",children:Object(f.jsx)("h2",{children:"\u5185\u5bb9\u7f16\u8f91"})}),Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var c=i;p.editProduct(c).then((function(e){return t.push("/product/".concat(e.data))}))},children:[Object(f.jsxs)("div",{className:"edit-item",children:[Object(f.jsx)("span",{children:"\u6807\u9898\uff1a"}),Object(f.jsx)("input",{type:"text",name:"name",value:i.name?i.name:"",onChange:function(e){return l(Object(m.a)(Object(m.a)({},i),{},{name:e.target.value}))}})]}),Object(f.jsxs)("div",{className:"edit-item",children:[Object(f.jsx)("span",{children:"\u6458\u8981\uff1a"}),Object(f.jsx)("input",{type:"text",name:"productAbstract",value:i.productAbstract?i.productAbstract:"",onChange:function(e){return l(Object(m.a)(Object(m.a)({},i),{},{productAbstract:e.target.value}))}})]}),Object(f.jsxs)("div",{className:"edit-item",children:[Object(f.jsx)("span",{children:"\u56fe\u7247\uff1a"}),Object(f.jsxs)("div",{className:"inp-url",children:[Object(f.jsx)("input",{type:"radio",name:"pic",value:"url",checked:b,onChange:function(){return h(!0)}}),"\u56fe\u7247\u5730\u5740"]}),Object(f.jsxs)("div",{className:"inp-file",children:[Object(f.jsx)("input",{type:"radio",name:"pic",value:"file",onChange:function(){return h(!1)}}),"\u4e0a\u4f20\u56fe\u7247"]}),Object(f.jsx)("div",{style:{display:b?"block":"none"},children:Object(f.jsx)("input",{type:"text",name:"imgUrl",value:i.imgUrl?i.imgUrl:"",onChange:function(e){return l(Object(m.a)(Object(m.a)({},i),{},{imgUrl:e.target.value}))}})}),Object(f.jsxs)("div",{style:{display:b?"none":"block"},children:[Object(f.jsx)("input",{type:"file",name:"file",id:"file"}),Object(f.jsx)("button",{className:"upload-btn",onClick:function(e){e.preventDefault();var t=document.querySelector("#file").files[0];if(t.size/1024>1024)window.alert("\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u4e0d\u5f97\u8d85\u8fc71MB\uff01");else{var c=t.name;if(-1!==c.indexOf(".")){var n=c.split(".")[1];if(-1!==["jpg","png","gif"].indexOf(n)){var a=new FormData;a.append("file",t),"dev"===A?o.a.post("http://localhost:8080/api/upload",a,{withCredentials:!0}).then((function(e){return e.data})).then((function(e){return window.alert("\u4e0a\u4f20\u6210\u529f")||l(Object(m.a)(Object(m.a)({},i),{},{imgUrl:e.data.url}))})).catch((function(e){return window.alert("\u4e0a\u4f20\u5931\u8d25")})):o.a.post("/api/upload",a).then((function(e){return e.data})).then((function(e){return window.alert("\u4e0a\u4f20\u6210\u529f")||l(Object(m.a)(Object(m.a)({},i),{},{imgUrl:e.data.url}))})).catch((function(e){return window.alert("\u4e0a\u4f20\u5931\u8d25")}))}else window.alert("\u8bf7\u4e0a\u4f20\u56fe\u7247\u683c\u5f0f\u6587\u4ef6")}else window.alert("\u8bf7\u4e0a\u4f20\u56fe\u7247\u683c\u5f0f\u6587\u4ef6")}},children:"\u4e0a\u4f20"})]})]}),Object(f.jsxs)("div",{className:"edit-item",children:[Object(f.jsx)("span",{className:"desc",children:"\u6b63\u6587\uff1a"}),Object(f.jsx)("textarea",{name:"description",value:i.description?i.description:"",rows:"10",placeholder:"2-1000\u4e2a\u5b57\u7b26",onChange:function(e){return l(Object(m.a)(Object(m.a)({},i),{},{description:e.target.value}))}})]}),Object(f.jsxs)("div",{className:"edit-item",children:[Object(f.jsx)("span",{children:"\u4ef7\u683c\uff1a"}),Object(f.jsx)("input",{className:"price",type:"text",name:"price",value:i.price?i.price:"",onChange:function(e){return l(Object(m.a)(Object(m.a)({},i),{},{price:e.target.value}))}}),"\u5143"]}),Object(f.jsx)("input",{type:"submit",value:"\u4fdd\u5b58"})]})]})};c(68);var D=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),c=t[0],a=t[1];return Object(n.useEffect)((function(){k.getCurrentUser().then((function(e){return a(e.data)}))}),[]),Object(f.jsxs)(l.a,{children:[c?Object(f.jsxs)("div",{className:"header",children:[Object(f.jsxs)("div",{className:"user",children:[c.userType&&c.userType!=O.BUYER?Object(f.jsx)("span",{children:"\u5356\u5bb6\u4f60\u597d"}):Object(f.jsx)("span",{children:"\u4e70\u5bb6\u4f60\u597d"}),Object(f.jsxs)("span",{children:["\uff0c"+c.username||!1,"!"]}),c.username?Object(f.jsx)("a",{onClick:function(e){e.preventDefault(),k.logout().then((function(e){return a(null)}))},href:"#",children:"[\u9000\u51fa]"}):Object(f.jsx)(l.b,{to:"/login",children:"[\u767b\u5f55]"})]}),Object(f.jsxs)("ul",{className:"nav",children:[Object(f.jsx)("li",{children:Object(f.jsx)("a",{href:"/",children:"\u9996\u9875"})},"index"),c.userType===O.BUYER?[Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/account",children:"\u8d26\u52a1"})},"account"),Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/cart",children:"\u8d2d\u7269\u8f66"})},"cart")]:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/publish",children:"\u53d1\u5e03"})},"publish")]})]}):Object(f.jsxs)("div",{className:"header",children:[Object(f.jsx)("div",{className:"user",children:Object(f.jsxs)("span",{children:["\u8bf7",Object(f.jsx)(l.b,{to:"/login",children:"[\u767b\u5f55]"})]})}),Object(f.jsx)("ul",{className:"nav",children:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/",children:"\u9996\u9875"})})})]}),Object(f.jsxs)(u.c,{children:[Object(f.jsx)(u.a,{path:"/",exact:!0,children:Object(f.jsx)(x,{user:c})}),Object(f.jsx)(u.a,{path:"/login",children:Object(f.jsx)(L,{})}),Object(f.jsx)(u.a,{path:"/product/:productId",children:Object(f.jsx)(N,{user:c})}),Object(f.jsx)(u.a,{path:"/cart",children:Object(f.jsx)(E,{user:c})}),Object(f.jsx)(u.a,{path:"/account",exact:!0,children:Object(f.jsx)(y,{user:c})}),Object(f.jsx)(u.a,{path:"/publish/:productId",children:Object(f.jsx)(B,{user:c})}),Object(f.jsx)(u.a,{path:"/publish",exact:!0,children:Object(f.jsx)(B,{user:c})})]})]})};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(D,{})}),document.getElementById("main"))}},[[69,1,2]]]);
//# sourceMappingURL=index.f266e4fd.chunk.js.map